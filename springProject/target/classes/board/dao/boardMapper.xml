<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boardSQL">
	<!-- 글쓰기 -->
	<insert id="boardWrite" parameterType="java.util.Map">
		insert into board(seq, id, name, email, subject, content, ref)
		values (seq_board.nextval
				, #{id}
				, #{name}
				, #{email}
				, #{subject}
				, #{content}
				, seq_board.currval)
		
	</insert>
	
	<!-- 페이징 처리  --> 
	<select id="getBoardList" parameterType="java.util.Map" resultType="board">
		<![CDATA[
		select * from
		(select rownum rn, tt.* from
		(select seq, id, name, email, subject, content, ref, lev, step, pseq, reply, hit,
		case
		when to_char(logtime, 'yyyy.mm.dd') = to_char(sysdate, 'yyyy.mm.dd')
		then to_char(logtime, 'pm hh:mi')
		else to_char(logtime, 'yyyy.mm.dd') end logtime
		from board
		order by ref desc, step asc)tt)
		where rn >= #{startNum} and rn <= #{endNum}
		]]>
	</select>
</mapper>